<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2021-08-09 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20210809" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Logger Tutorial &#x2013; Logger Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://officefloor.net/" id="bannerLeft">
                                                                                        <img src="https://officefloor.net/images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Logger Tutorial">
        Logger Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Logger Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-08-09</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.39.0
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/LoggerHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="https://officefloor.net/images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Logger_Tutorial"></a>Logger Tutorial</h2>
<p>This tutorial demonstrates using logging.</p>
<p>To focus on logging, this tutorial uses a simple application that logs the input string sent by the client. </p>
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/LoggerHttpServer">Tutorial Source</a></p>
<div class="section">
<h3><a name="Logging_from_procedure"></a>Logging from procedure</h3>
<p>To log from a first-class procedure, have the <tt>Logger</tt> injected as follows:</p>
<div class="source"><pre class="prettyprint">	public void log(LoggedRequest request, Logger procedureLogger, LogObject object) {

		// Log the request via procedure logger
		procedureLogger.info(&quot;PROCEDURE: &quot; + request.getMessage());

		// Have dependency injected object use it's logger
		object.log(request);
	}
</pre></div>
<p>The <tt>Logger</tt> will log the message from the input request object:</p>
<div class="source"><pre class="prettyprint">@HttpObject
@Data
@AllArgsConstructor
@NoArgsConstructor
public class LoggedRequest {
	private String message;
}
</pre></div></div>
<div class="section">
<h3><a name="Logging_from_object"></a>Logging from object</h3>
<p>As alluded to in the procedure, it is also possible to log from an injected object. The injected object is as follows:</p>
<div class="source"><pre class="prettyprint">public class LogObject {

	private @Dependency Logger logger;

	public void log(LoggedRequest request) {
		this.logger.info(&quot;OBJECT: &quot; + request.getMessage());
	}
}
</pre></div>
<p>The <tt>Logger</tt> for the object is different to the procedure. This is because the respective injected <tt>Logger</tt> identifies each component individually in the log.</p></div>
<div class="section">
<h3><a name="Why_inject_the_Logger.3F"></a>Why inject the Logger?</h3>
<p>Statically creating, i.e. <tt>Logger.getLogger(&quot;name&quot;)</tt>, ties the <tt>Logger</tt> to the creating <tt>Class</tt>. This is ok for Dependency Injection only frameworks. These frameworks typically only have single instances of classes serving a request (i.e. an application, thread local or request scoped singleton). Therefore, inferring the class name in the log messages provides reasonable traceability to the single instance of the class logging the message.</p>
<p>When building with <a class="externalLink" href="https://sagenschneider.blogspot.com/2019/02/inversion-of-coupling-control.html">Inversion of Coupling Control</a>, there is a lot more re-use of classes. Just identifying the class name does not identify the various places the class may be re-used.</p>
<p>The injected <tt>Logger</tt> is configured to identify the component within the application. Therefore, if the <tt>Class</tt> is re-used in the configuration of the application, the logs don't become ambiguous. The logs will identify the component within the application configuration. Just follow the dot notation down the levels of configuration. </p></div>
<div class="section">
<h3><a name="Testing"></a>Testing</h3>
<p>The following test demonstrates the component naming of the injected <tt>Logger</tt> instances:</p>
<div class="source"><pre class="prettyprint">	@RegisterExtension
	public MockWoofServerExtension server = new MockWoofServerExtension();

	@RegisterExtension
	public LoggerExtension log = new LoggerExtension();

	@Test
	public void ensureLogging() {

		// Send request to be logged
		MockHttpResponse response = this.server
				.send(MockWoofServer.mockJsonRequest(HttpMethod.POST, new LoggedRequest(&quot;TEST&quot;)));
		response.assertResponse(204, &quot;&quot;);

		// Ensure log input message (from procedure)
		this.log.assertLog(&quot;log.procedure&quot;, Level.INFO, &quot;PROCEDURE: TEST&quot;);

		// Ensure log from object
		this.log.assertLog(&quot;OFFICE.net_officefloor_tutorial_loggerhttpserver_LogObject&quot;, Level.INFO, &quot;OBJECT: TEST&quot;);
	}
</pre></div>
<p>JUnit 4 example:</p>
<div class="source"><pre class="prettyprint">	@Rule
	public final MockWoofServerRule server = new MockWoofServerRule(this);

	@Rule
	public final LoggerRule log = new LoggerRule();

	@Test
	public void ensureLogging() {

		// Send request to be logged
		MockHttpResponse response = this.server
				.send(MockWoofServer.mockJsonRequest(HttpMethod.POST, new LoggedRequest(&quot;TEST&quot;)));
		response.assertResponse(204, &quot;&quot;);

		// Ensure log input message (from procedure)
		this.log.assertLog(&quot;log.procedure&quot;, Level.INFO, &quot;PROCEDURE: TEST&quot;);

		// Ensure log from object
		this.log.assertLog(&quot;OFFICE.net_officefloor_tutorial_loggerhttpserver_LogObject&quot;, Level.INFO, &quot;OBJECT: TEST&quot;);
	}
</pre></div></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../JwtResourceHttpServer/index.html">next tutorial</a> covers JWT security.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2021
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
