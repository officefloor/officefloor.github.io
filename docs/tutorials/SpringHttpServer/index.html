<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2021-07-02 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20210702" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Spring HTTP Server Tutorial &#x2013; Spring HTTP Server Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://officefloor.net/" id="bannerLeft">
                                                                                        <img src="https://officefloor.net/images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Spring HTTP Server Tutorial">
        Spring HTTP Server Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Spring HTTP Server Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-07-02</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.37.0
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/SpringHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="https://officefloor.net/images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Spring_HTTP_Server_Tutorial"></a>Spring HTTP Server Tutorial</h2>
<p>This tutorial demonstrates wiring Spring beans into an OfficeFloor application.</p>
<p>The following simple output is provided via a Spring bean injected into a WoOF template:</p><img src="./images/SpringHttpServer-screenshot.png" alt="SpringHttpServer screen shot." />
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/SpringHttpServer">Tutorial Source</a></p>
<div class="section">
<h3><a name="Spring"></a>Spring</h3>
<p>In terms of Inversion of Control, Spring focuses heavily on Dependency Injection. This makes Spring a very useful library of pre-built objects. In actuality Spring has provided great abstract APIs across various different vendors for various key services (e.g. <a class="externalLink" href="http://spring.io/projects/spring-data">Spring Data</a>).</p>
<p>However, Spring is still primarily only a Dependency Injection engine. It does not provide Continuation Injection nor Thread Injection for modeling functionality and execution of your applications.</p>
<p>Therefore, rather than re-invent the wheel for these great APIs, OfficeFloor enables integrating Spring in as a <a href="/apidocs/net/officefloor/compile/spi/supplier/source/SupplierSource.html">SupplierSource</a> (supplier of objects for dependency injection).</p></div>
<div class="section">
<h3><a name="Supplier"></a>Supplier</h3>
<p>Similar to suppliers providing items to a business, a <a href="/apidocs/net/officefloor/compile/spi/supplier/source/SupplierSource.html">SupplierSource</a> supplies objects to OfficeFloor dependency injection. This is a convenient means for Dependency Injection frameworks, such as Spring, to provide their objects to OfficeFloor.</p>
<p>The following is the object configuration for this tutorial:</p>
<div class="source"><pre class="prettyprint">&lt;objects&gt;
	
	&lt;supplier source=&quot;SPRING&quot;&gt;
		&lt;property name=&quot;configuration.class&quot; value=&quot;net.officefloor.tutorial.springhttpserver.SpringBootConfiguration&quot; /&gt;
	&lt;/supplier&gt;

	&lt;managed-object class=&quot;net.officefloor.tutorial.springhttpserver.World&quot; /&gt;

&lt;/objects&gt;
</pre></div>
<p>The <a href="/apidocs/net/officefloor/spring/SpringSupplierSource.html">SpringSupplierSource</a> is configured via it's <a href="/apidocs/net/officefloor/spring/SpringSupplierSourceService.html">SPRING</a> alias.</p>
<p>Similar to <a class="externalLink" href="http://spring.io/projects/spring-boot">Spring Boot</a> applications, a configuration class loads the Spring beans. The configured class is as follows:</p>
<div class="source"><pre class="prettyprint">@SpringBootApplication
public class SpringBootConfiguration {

	@Bean
	public Other other() {
		return SpringSupplierSource.getManagedObject(null, Other.class);
	}
}
</pre></div>
<p>This provides the following single Spring bean for dependency injection via class path scanning:</p>
<div class="source"><pre class="prettyprint">@Component
public class HelloBean {

	@Autowired
	private Other other;

	public String getIntroduction() {
		return &quot;Hello &quot; + this.other.getName() + &quot;, from Spring&quot;;
	}
}
</pre></div>
<p>The <a href="/apidocs/net/officefloor/spring/SpringSupplierSource.html">SpringSupplierSource</a> interogates all the registered Spring beans and makes them available for auto-wiring within OfficeFloor.</p>
<p>Therefore, the template logic to use the Spring beans is no different to WoOF dependency injection of <a href="/apidocs/net/officefloor/frame/api/managedobject/source/ManagedObjectSource.html">ManagedObjectSource</a> instances:</p>
<div class="source"><pre class="prettyprint">public class Template {

	public HelloBean getTemplate(HelloBean bean) {
		return bean;
	}
}
</pre></div>
<p>with the very simple template to output the bean's introduction as follows:</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
	&lt;body&gt;
		&lt;p&gt;${introduction}&lt;/p&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></div></div>
<div class="section">
<h3><a name="Spring_depending_on_OfficeFloor"></a>Spring depending on OfficeFloor</h3>
<p>In the previous section, the Spring bean required a dependency to be injected. This dependency is provided by an OfficeFloor <a href="/apidocs/net/officefloor/frame/api/managedobject/source/ManagedObjectSource.html">ManagedObjectSource</a>. This enables:</p>
<ul>
<li>OfficeFloor to depend on Spring beans</li>
<li>Spring beans to depend on the richer OfficeFloor <a href="/apidocs/net/officefloor/frame/api/managedobject/source/ManagedObjectSource.html">ManagedObjectSource</a> instances</li></ul>
<p>Looking at the Spring Boot configuration class again:</p>
<div class="source"><pre class="prettyprint">@SpringBootApplication
public class SpringBootConfiguration {

	@Bean
	public Other other() {
		return SpringSupplierSource.getManagedObject(null, Other.class);
	}
}
</pre></div>
<p>The dependency is provided from the <a href="/apidocs/net/officefloor/spring/SpringSupplierSource.html">SpringSupplierSource</a>. This enables Spring factory methods to create beans from <a href="/apidocs/net/officefloor/frame/api/managedobject/source/ManagedObjectSource.html">ManagedObjectSource</a> instances within OfficeFloor.</p>
<p>From the application object configuration above, this resolves to the following:</p>
<div class="source"><pre class="prettyprint">public class World implements Other {

	@Override
	public String getName() {
		return &quot;OfficeFloor&quot;;
	}
}
</pre></div>
<p>Note that exposed objects from OfficeFloor must be via an interface. The interface for this tutorial is:</p>
<div class="source"><pre class="prettyprint">public interface Other {

	String getName();
}
</pre></div>
<p>Typically, Spring depending on OfficeFloor objects should be used sparingly. In most cases, dependency should be single direction of OfficeFloor depending on Spring beans. However, the above reverse in dependency direction is available for more complex situations (e.g. staged migration of Spring beans into <a href="/apidocs/net/officefloor/frame/api/managedobject/source/ManagedObjectSource.html">ManagedObjectSource</a> instances to avoid <i>big bang</i> changes).</p></div>
<div class="section">
<h3><a name="Building_the_application"></a>Building the application</h3>
<p>Due to Spring Boot generating meta-data about the application to run, the following should be used to build the executable jar:</p>
<div class="source"><pre class="prettyprint">			&lt;plugin&gt;
				&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
				&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
				&lt;configuration&gt;
					&lt;mainClass&gt;net.officefloor.OfficeFloorMain&lt;/mainClass&gt;
					&lt;classifier&gt;exec&lt;/classifier&gt;
				&lt;/configuration&gt;
				&lt;executions&gt;
					&lt;execution&gt;
						&lt;goals&gt;
							&lt;goal&gt;repackage&lt;/goal&gt;
						&lt;/goals&gt;
					&lt;/execution&gt;
				&lt;/executions&gt;
			&lt;/plugin&gt;
</pre></div>
<p>This ensures Spring Boot can generate the necessary meta-data, while still allowing OfficeFloor to manage the execution. It also keeps the original jar (via the classifier) to allow using as a dependency in larger applications.</p></div>
<div class="section">
<h3><a name="Unit_Test"></a>Unit Test</h3>
<p>Suppliers are integrated into OfficeFloor, so the application can be tested just like any other WoOF application:</p>
<div class="source"><pre class="prettyprint">	@RegisterExtension
	public MockWoofServerExtension server = new MockWoofServerExtension();

	@Test
	public void springHello() throws Exception {

		// Send request for dynamic page
		MockHttpResponse response = this.server.send(MockHttpServer.mockRequest(&quot;/&quot;));

		// Ensure request is successful
		assertEquals(200, response.getStatus().getStatusCode(), &quot;Request should be successful&quot;);
		assertTrue(response.getEntity(null).contains(&quot;Hello OfficeFloor, from Spring&quot;), &quot;Incorrect response&quot;);
	}
</pre></div></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../FlywayHttpServer/index.html">next tutorial</a> covers migrating databases on start up via <a class="externalLink" href="https://flywaydb.org/">Flyway</a>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2021
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
