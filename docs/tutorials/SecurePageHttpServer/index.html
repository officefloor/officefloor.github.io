<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2021-07-02 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20210702" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Secure page HTTP Server Tutorial &#x2013; Secure Page Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://officefloor.net/" id="bannerLeft">
                                                                                        <img src="https://officefloor.net/images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Secure page HTTP Server Tutorial">
        Secure page HTTP Server Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Secure Page Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-07-02</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.37.0
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/SecurePageHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="https://officefloor.net/images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Secure_Page_Tutorial"></a>Secure Page Tutorial</h2>
<p>This tutorial looks at configuring a page to only be accessed via a secure channel (HTTPS).</p>
<p>The below example for this tutorial will implement a simple page to capture card details. The simple page for this tutorial is as follows:</p><img src="./images/SecurePageHttpServer-screenshot.png" alt="SecurePageHttpServer screen shot." />
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/SecurePageHttpServer">Tutorial Source</a></p>
<div class="section">
<h3><a name="Secure_Page"></a>Secure Page</h3>
<p>To configure the page to always be accessed via a secure channel, the following is the configuration for the page:</p><img src="./images/SecurePageHttpServer-configuration.png" alt="Secure Page configuration screen shot." />
<p>Checking the secure check box is the only configuration necessary to ensure use of a secure channel (HTTPS) for accessing the page.</p>
<p>To ease development, WoOF by default runs with a generic security key that is self signed. Typically for development and testing this will require trusting the key within the browser to access the page. This default setup should only be used for development/testing to avoid manual key setup.</p>
<p>For production, a trusted third-party signed security key is recommended to be configured.</p>
<p>Please also see the <a href="/apidocs/net/officefloor/server/http/HttpServerLocation.html">HttpServerLocation</a> for details on configuring the web application's location for generation of the link URLs.</p></div>
<div class="section">
<h3><a name="Template"></a>Template</h3>
<p>The page template content is as follows:</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
	&lt;body&gt;
		&lt;h1&gt;Enter card details&lt;/h1&gt;
		&lt;form action=&quot;#{save}&quot; method=&quot;POST&quot;&gt;
			Card number: &lt;input type=&quot;text&quot; name=&quot;number&quot; value=&quot;${number}&quot; size=&quot;19&quot; /&gt; &lt;br /&gt;
			Expiry date: &lt;input type=&quot;text&quot; name=&quot;month&quot; value=&quot;${month}&quot; size=&quot;2&quot; /&gt; / 
							&lt;input type=&quot;text&quot; name=&quot;year&quot; value=&quot;${year}&quot; size=&quot;4&quot; /&gt;
			CSC: &lt;input type=&quot;text&quot; name=&quot;csc&quot; value=&quot;${csc}&quot; size=&quot;3&quot; /&gt; &lt;br /&gt;
			&lt;input type=&quot;submit&quot; value=&quot;save&quot; /&gt;
		&lt;/form&gt;
		&lt;a href=&quot;#{main}&quot;&gt;Back to main page&lt;/a&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></div>
<p>This is similar HTML to previous tutorials.</p></div>
<div class="section">
<h3><a name="Logic_Class"></a>Logic Class</h3>
<p>The logic for the page is the following:</p>
<div class="source"><pre class="prettyprint">public class CardLogic {

	@Data
	@HttpParameters
	public static class CardDetails implements Serializable {
		private static final long serialVersionUID = 1L;

		private String number;

		private String month;

		private String year;

		private String csc;
	}

	public CardDetails getTemplateData(CardDetails cardDetails, ServerHttpConnection connection) {

		// Confirm a secure connection (not needed but included for tutorial)
		if (!connection.isSecure()) {
			throw new IllegalStateException();
		}

		// Return the card details for rendering
		return cardDetails;
	}

	public void save(CardDetails cardDetails, ServerHttpConnection connection) {

		// Confirm a secure connection (not needed but included for tutorial)
		if (!connection.isSecure()) {
			throw new IllegalStateException();
		}

		// Logic for processing the card details
	}

}
</pre></div>
<p>Again this is similar to previous tutorials.</p></div>
<div class="section">
<h3><a name="Remaining_Code"></a>Remaining Code</h3>
<p>The main page is included for completeness of the tutorial code.</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
	&lt;body&gt;
		&lt;h1&gt;Main Page&lt;/h1&gt;
		&lt;a href=&quot;#{card}&quot;&gt;Enter card details&lt;/a&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></div></div>
<div class="section">
<h3><a name="Unit_Test"></a>Unit Test</h3>
<p>The unit test requests the page:</p>
<ul>
<li>directly</li>
<li>via a link from another page</li></ul>
<p>The exception within the page logic ensures rendering the response only occurs over a secure channel (HTTPS).</p>
<div class="source"><pre class="prettyprint">@ExtendWith(OfficeFloorExtension.class)
public class SecurePageTest {

	@RegisterExtension
	public final HttpClientExtension client = new HttpClientExtension(true);

	@Test
	public void testSecurePage() throws Exception {

		// Ensure redirect to secure access to page
		this.assertHttpRequest(&quot;http://localhost:7878/card&quot;);

		// Ensure redirect to secure link access to page
		this.assertHttpRequest(&quot;http://localhost:7878/main+card&quot;);
	}

	private void assertHttpRequest(String url) throws IOException {
		HttpResponse response = this.client.execute(new HttpGet(url));
		assertEquals(200, response.getStatusLine().getStatusCode(), &quot;Should be successful (after possible redirect)&quot;);
		String entity = EntityUtils.toString(response.getEntity());
		assertTrue(entity.contains(&quot;&lt;h1&gt;Enter card details&lt;/h1&gt;&quot;),
				&quot;Should be rendering page as secure (and not exception)&quot;);
	}

}
</pre></div></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../SecureLinkHttpServer/index.html">next tutorial</a> looks at securing a specific link.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2021
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
