<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2021-03-21 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20210321" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Navigate HTTP Server Tutorial &#x2013; Configuring Flow Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://officefloor.net/" id="bannerLeft">
                                                                                        <img src="https://officefloor.net/images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Navigate HTTP Server Tutorial">
        Navigate HTTP Server Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Configuring Flow Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-03-21</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.33.0
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/NavigateHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="https://officefloor.net/images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Configuring_Flow_Tutorial"></a>Configuring Flow Tutorial</h2>
<p>This tutorial demonstrates configuring flows within a WoOF application.</p>
<p>Flows are means to compose/link the execution of one method to another method. They are the continuations in Continuation Injection of <a class="externalLink" href="https://sagenschneider.blogspot.com/2019/02/inversion-of-coupling-control.html">Inversion of Coupling Control</a>. We, however, find the term <tt>flow</tt> easier to understand (plus it's less typing).</p>
<p>The flow is represented as connections in the <tt>application.woof</tt>. By having the graphical configuration, it makes </p>
<ul>
<li>refactoring your applications significantly easier</li>
<li>much easier for new developers to comprehend how the application works</li>
<li>easier to demonstrate to non-technical users why certain changes (refactorings) need to be made</li>
<li>easier to show why some changes are harder, while others easier</li>
<li>plus many other great reasons</li></ul>
<p><i>Just as a note</i>: while much of the web is now dominated by rich front-ends calling to back-end service APIs, we will focus on dynamic web pages. This allows you something tangible to try out in browsers (rather than constructing REST calls). Plus, the use of flows between REST and dynamic web pages is similar. See the <a href="../index.html">other tutorials</a> regarding building richer applications.</p>
<p>Therefore, to simplify demonstrating flows, the following two web pages are used in this tutorial:</p><img src="./images/NavigateHttpServer-one-screenshot.png" alt="NavigateHttpServer one screen shot." /><img src="./images/NavigateHttpServer-two-screenshot.png" alt="NavigateHttpServer two screen shot." />
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/NavigateHttpServer">Tutorial Source</a></p></div>
<div class="section">
<h2><a name="application.woof"></a>application.woof</h2>
<p>The following shows the configuration of the two web page templates and the navigation between the templates.</p><img src="./images/navigate-woof.png" alt="application.woof configuration." />
<p>The links are the navigation paths between the templates. Each template provides outputs that by the above configuration navigates the user to the other page.</p></div>
<div class="section">
<h2><a name="a.40Next"></a>@Next</h2>
<p>The first template provides a link to navigate to the other template.</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;One&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/one.css&quot; /&gt;
    &lt;/head&gt;
	&lt;body&gt;
		&lt;h1&gt;Page One&lt;/h1&gt;
		&lt;a href=&quot;#{navigate}&quot;&gt;link&lt;/a&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></div>
<p>The link is handled by the following method. This is because the method name matches the link name in the template.</p>
<p>The annotation indicates the next function within the flow.</p>
<div class="source"><pre class="prettyprint">public class TemplateOne {

	@Next(&quot;external&quot;)
	public void navigate() {
	}

}
</pre></div>
<p>As the next function name is not a name of another method (and not a template section name) it becomes an output from the template. From the configuration above the output is configured to navigate to the other template.</p>
<p>This is useful should some action be required to be taken when the user clicks to navigate to the next page.</p></div>
<div class="section">
<h2><a name="a.40FlowInterface"></a>@FlowInterface</h2>
<p>The second template uses a submit to navigate to the first template.</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Two&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./css/two.css&quot; /&gt;
    &lt;/head&gt;
	&lt;body&gt;
		&lt;h1&gt;Page Two&lt;/h1&gt;
		&lt;form action=&quot;#{process}&quot;&gt;
			&lt;input type=&quot;submit&quot; /&gt;
		&lt;/form&gt;
	&lt;/body&gt;
&lt;/html&gt;
</pre></div>
<p>Much like the first template the logic class also navigates to an external flow. In this case it uses an interface for programmatic control of navigation.</p>
<div class="source"><pre class="prettyprint">public class TemplateTwo {

	@FlowInterface
	public interface Flows {
		void next();
	}

	public void process(Flows flows) {
		flows.next();
	}

}
</pre></div>
<p>As the interface is dependency injected, WoOF sees the <tt>@FlowInterface</tt> annotation and will provide an implementation of the interface. Each method on the interface will be linked by name to one of the following:</p>
<ul>
<li>a method on the template logic class</li>
<li>a section of the template</li>
<li>an external flow from the template. This is then linked by the <tt>application.woof</tt> configuration (as is the case above)</li></ul>
<p>This allows programmatically determining which is the next function. It is possible to add further methods to the interface to provide alternate navigation paths. Navigation only occurs if the method is invoked. Please also be aware that navigation to the page happens after the current method has completed.</p>
<p>Both <tt>@Next</tt> and <tt>@FlowInterface</tt> may also be used in combination. <tt>@Next</tt> will provide the default next unless overridden by a method of a <tt>@FlowInterface</tt> being invoked.</p>
<p>The above configuration has the external flow linked back to the first template.</p></div>
<div class="section">
<h2><a name="Unit_Test"></a>Unit Test</h2>
<p>The unit test navigates between the templates.</p>
<div class="source"><pre class="prettyprint">@ExtendWith(OfficeFloorExtension.class)
public class NavigateHttpServerTest {

	@RegisterExtension
	public final HttpClientExtension client = new HttpClientExtension();

	@Test
	public void testNavigate() throws Exception {

		// Request template one
		HttpResponse response = this.client.execute(new HttpGet(this.client.url(&quot;/one&quot;)));
		assertEquals(200, response.getStatusLine().getStatusCode(), &quot;First page should be successful&quot;);
		assertTrue(EntityUtils.toString(response.getEntity()).contains(&quot;Page One&quot;), &quot;Should obtain first page&quot;);

		// Click on link on template one
		response = this.client.execute(new HttpGet(this.client.url(&quot;/one+navigate&quot;)));
		assertEquals(200, response.getStatusLine().getStatusCode(), &quot;Second page should be successful&quot;);
		assertTrue(EntityUtils.toString(response.getEntity()).contains(&quot;Page Two&quot;), &quot;Should navigate to second page&quot;);

		// Submit on template two
		response = this.client.execute(new HttpGet(this.client.url(&quot;/two+process&quot;)));
		assertEquals(200, response.getStatusLine().getStatusCode(), &quot;Submit should be successful&quot;);
		assertTrue(EntityUtils.toString(response.getEntity()).contains(&quot;Page One&quot;), &quot;Should submit template two&quot;);
	}
}
</pre></div>
<p>JUnit 4 example:</p>
<div class="source"><pre class="prettyprint">public class NavigateHttpServerJUnit4Test {

	@Rule
	public final OfficeFloorRule officeFloor = new OfficeFloorRule(this);

	@Rule
	public final HttpClientRule client = new HttpClientRule();

	@Test
	public void testNavigate() throws Exception {

		// Request template one
		HttpResponse response = this.client.execute(new HttpGet(this.client.url(&quot;/one&quot;)));
		assertEquals(&quot;First page should be successful&quot;, 200, response.getStatusLine().getStatusCode());
		assertTrue(&quot;Should obtain first page&quot;, EntityUtils.toString(response.getEntity()).contains(&quot;Page One&quot;));

		// Click on link on template one
		response = this.client.execute(new HttpGet(this.client.url(&quot;/one+navigate&quot;)));
		assertEquals(&quot;Second page should be successful&quot;, 200, response.getStatusLine().getStatusCode());
		assertTrue(&quot;Should navigate to second page&quot;, EntityUtils.toString(response.getEntity()).contains(&quot;Page Two&quot;));

		// Submit on template two
		response = this.client.execute(new HttpGet(this.client.url(&quot;/two+process&quot;)));
		assertEquals(&quot;Submit should be successful&quot;, 200, response.getStatusLine().getStatusCode());
		assertTrue(&quot;Should submit template two&quot;, EntityUtils.toString(response.getEntity()).contains(&quot;Page One&quot;));
	}
}
</pre></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../ExceptionHttpServer/index.html">next tutorial</a> looks at exception handling.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2021
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
