<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2021-03-21 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20210321" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Dynamic HTTP Server Tutorial &#x2013; Dynamic Rendering Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://officefloor.net/" id="bannerLeft">
                                                                                        <img src="https://officefloor.net/images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Dynamic HTTP Server Tutorial">
        Dynamic HTTP Server Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Dynamic Rendering Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-03-21</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.33.0
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/DynamicHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="https://officefloor.net/images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Dynamic_Rendering_Tutorial"></a>Dynamic Rendering Tutorial</h2>
<p>This tutorial demonstrates the simplicity in rendering dynamic content for a WoOF web application.</p>
<p>The example used in this tutorial is the following simple dynamic page to show the current time and the listing of System properties:</p><img src="./images/DynamicHttpServer-screenshot.png" alt="DynamicHttpServer screen shot." />
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/DynamicHttpServer">Tutorial Source</a></p>
<div class="section">
<h3><a name="Template.woof.html"></a>Template.woof.html</h3>
<p>The HTML for the page is as follows:</p>
<div class="source"><pre class="prettyprint">&lt;html&gt;
	&lt;body&gt;
		&lt;p&gt;Current time is ${time}&lt;/p&gt;
		&lt;table&gt;
			&lt;tr&gt;
				&lt;td&gt;Name&lt;/td&gt;
				&lt;td&gt;Value&lt;/td&gt;
			&lt;/tr&gt;
			&lt;!-- ${properties --&gt;
			&lt;tr&gt;
				&lt;td&gt;${name}&lt;/td&gt;
				&lt;td&gt;${value}&lt;/td&gt;
			&lt;/tr&gt;
			&lt;!-- $} --&gt;
		&lt;/table&gt;
		${noBean &lt;p&gt;This content will not be rendered&lt;/p&gt; $}
	&lt;/body&gt;
&lt;/html&gt;
</pre></div>
<p>First thing to notice is that the page/template can be rendered in a web browser. The reason for this is to ensure that web page content can be created/edited by WYSIWYG web design tools. This is deliberate to allow web page designers to focus on presentation of the web pages rather than having to understand scripting tags and to an extent programming constructs. It also means the template can be viewed without having written any code - great for reviewing and tweaking the pages.</p>
<p>To provide the developer control of rendering the dynamic content, there are non-obtrusive hooks for dynamically rending of the page. The two hooks used in the above template are:</p>
<ul>
<li><tt>${property}</tt> : which renders a bean property value to the page.</li>
<li><tt>${bean ... $}</tt> : indicates to obtain a bean by the property name to render the contents within the brackets. This may optionally be placed inside a comment to not intrude on the HTML.</li></ul></div>
<div class="section">
<h3><a name="TemplateLogic_Class"></a>TemplateLogic Class</h3>
<p>The logic for the rendering the page is the following POJO (plain old java object).</p>
<p>Please note that WoOF integrates with <a class="externalLink" href="http://projectlombok.org/">Project Lombok</a> to reduce the necessary code. As per below the <tt>@Data</tt> annotations are used to generate the getters and constructors for the inner class beans. It is highly recommended by the OfficeFloor team to consider use of <a class="externalLink" href="http://projectlombok.org/">Project Lombok</a> to reduce the overall amount of code to be written. </p>
<div class="source"><pre class="prettyprint">public class TemplateLogic {

	@Data
	public static class Values {

		private final String time;

		private final Property[] properties;

		private final Object noBean;
	}

	@Data
	public class Property {

		private final String name;

		private final String value;
	}

	/**
	 * Reflectively invoked by WoOF to obtain the dynamic values to render to
	 * the page.
	 * 
	 * @return Bean containing the dynamic values to render to the page
	 *         identified by bean property name.
	 */
	public Values getTemplateData() {

		// Obtain the time
		String time = SimpleDateFormat.getTimeInstance().format(new Date());

		// Create the listing of properties
		List&lt;Property&gt; properties = new LinkedList&lt;Property&gt;();
		for (String name : System.getProperties().stringPropertyNames()) {
			String value = System.getProperty(name);
			properties.add(new Property(name, value));
		}

		// Return the populated values
		return new Values(time, properties.toArray(new Property[properties
				.size()]), null);
	}

}
</pre></div>
<p>WoOF reflectively invokes the <tt>getTemplateData</tt> method to obtain the bean containing the properties and further beans for dynamically rendering the page. The returned object from the method is interrogated for the properties and beans. In the case of above:</p>
<ul>
<li><tt>${time}</tt> : is mapped to <tt>Values.getTime()</tt> to obtain the value to render to the page.</li>
<li><tt>${properties</tt> : is mapped to the <tt>Values.getProperties()</tt> to obtain the bean to render the content within the brackets (i.e. up to the corresponding <tt>$}</tt>).</li>
<li><tt>${noBean</tt> : is mapped to the <tt>Values.getNoBean()</tt> which returns <tt>null</tt> causing the contents to not be rendered.</li></ul>
<p>WoOF makes generating repeating content, such as tables, very simple. As the <tt>Values.getProperties()</tt> returns an array of <tt>Property</tt> objects, the contents are rendered for each element in the array. As the contents have two further properties (<tt>${name}</tt> and <tt>${value}</tt>) these are taken from the current <tt>Property</tt> being rendered.</p>
<p>It is possible to have beans contain further beans to allow complex data structures to be rendered to the page.</p>
<p>To ensure integration between the Web Page Designer and Developer the bindings between the template and logic class are checked at start up so that missing bean and property methods are flagged immediately. It is these binding checks that allow the two roles to work efficiently together.</p>
<p>The <tt>TemplateLogic</tt> class has been kept simple in this example returning static content. Later tutorials will demonstrate the use of dependency injection into methods to allow retrieving values from a HTTP session, database, etc.</p></div>
<div class="section">
<h3><a name="application.woof"></a>application.woof</h3>
<p>Now that the HTML template and logic class are available, they need to be configured into the WoOF application. This configuration is within the <tt>application.woof</tt> file at the root of the class path (i.e. has no package prefix). Under the hood this is an XML file however OfficeFloor has a strong focus on not hand coding XML configuration files. <a href="../../install.html">IDE plug-ins</a> provides the graphical configuration of the WoOF web application.</p>
<p>The reason for using graphical configuration is two fold:</p>
<ol style="list-style-type: decimal">
<li>XML configuration files are error prone and can become quite verbose making them difficult to manage</li>
<li>Graphical configuration allows other less technically inclined to review the functionality of the web application</li></ol>
<p>Once the IDE plug-in is installed you will be able to use the new wizard to create the <tt>application.woof</tt> file. On creating and opening there should be a blank editor. To make configuration changes:</p>
<ul>
<li>hover the mouse on the left of the editor will bring up the pallete. From this you can drag in new items for configuring.</li>
<li>dragging in a new item will provide a dialogue to configure the item</li>
<li>should you want to change the configuration of an item, however the mouse over it and click on the edit button that appears</li>
<li>to delete, again however over the item, and click the delete button</li>
<li>to wire up connections, click on an arrow within an item and then drag to the connecting arrow of another item</li></ul>
<p>For the tutorial, you need only the following configuration:</p><img src="./images/DynamicHttpServer-configuration.png" alt="DynamicHttpServer configuration." />
<p>This is the only configuration necessary for this web application. The template will be made available at <tt>http://localhost:7878/example</tt> . Later tutorials will look at linking page flows and dynamic behaviour.</p></div>
<div class="section">
<h3><a name="Unit_Test"></a>Unit Test</h3>
<p>As the template logic is just a POJO, WoOF adheres to OfficeFloor's focus on simplicity in testing. The following example unit test shows the ease in which the <tt>TemplateLogic</tt> class can be unit tested.</p>
<div class="source"><pre class="prettyprint">	@Test
	public void templateLogic() {

		TemplateLogic logic = new TemplateLogic();

		assertEquals(System.getProperties().size(), logic.getTemplateData().getProperties().length,
				&quot;Number of properties&quot;);

	}
</pre></div></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../InteractiveHttpServer/index.html">next tutorial</a> will look at an interactive page.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2021
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
