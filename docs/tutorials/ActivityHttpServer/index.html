<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 at 2020-11-24 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Daniel Sagenschneider" />
    <meta name="Date-Revision-yyyymmdd" content="20201124" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Activity Tutorial &#x2013; Activity Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <!-- shortcut icon -->
			<link rel="shortcut icon" href="/favicon.ico" />
			
			<!-- www.addthis.com (for sharing) -->
			<script type="text/javascript">
				$(document).ready(function() {
					var addThisScript = document.createElement("script");
					addThisScript.type = 'text/javascript';
					addThisScript.src = '//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c6e0c0bac25d2cf';
					document.body.appendChild(addThisScript);
				})
			</script>
                  <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23477455-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
          </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/officefloor/OfficeFloor">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.officefloor.net/" id="bannerLeft">
                                                                                                <img src="../../images/OfficeFloorBannerImage.png"  alt="OfficeFloor"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="../../index.html" title="OfficeFloor">
        OfficeFloor</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Tutorials">
        Tutorials</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="Activity Tutorial">
        Activity Tutorial</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Activity Tutorial</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2020-11-24</li>
              <li id="projectVersion" class="pull-right">
                    Version: 3.28.2
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../index.html" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="officefloor.net/officefloor/tutorials/ActivityHttpServer/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="https://github.com/sponsors/sagenschneider" title="Support" class="builtBy">
        <img class="builtBy"  alt="Support" src="../../images/sponsor.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section">
<h2><a name="Activity_Tutorial"></a>Activity Tutorial</h2>
<p>This tutorial demonstrates modularising configuration.</p>
<p>To focus on modular configuration, this tutorial uses a simple application that returns the depth of modules within modules. </p>
<p><a class="externalLink" href="https://github.com/officefloor/OfficeFloor/tree/master/officefloor/tutorials/ActivityHttpServer">Tutorial Source</a></p>
<div class="section">
<h3><a name="Background"></a>Background</h3>
<p>Modularising configuration is necessary when working on bigger projects by bigger teams.</p>
<p>Trying to configure all logic of a large application into the single WoOF configuration file yields a lot of complexity. The idea of the graphical configuration is easy understanding of how the application is put together. When the single graphical configuration file becomes too involved it looses its readability. Therefore, it is broken into modules to make it easier to understand.</p>
<p>Also, scaling teams requires developers to work in isolated parts of the applications. Having the single configuration file creates a focal point for changes. This causes developers to <i>step on each other's toes</i> and creates problems through increased number of merge conflicts. Breaking configuration into smaller files reduces risk of merge conflicts.</p>
<p>By modularising the configuration to smaller files, it allows:</p>
<ul>
<li>developers to work in isolation of each other</li>
<li>lower chances of merge conflicts</li>
<li>easier to comprehend configuration</li>
<li>less responsibilities for individual configuration files</li>
<li>and many other benefits</li></ul></div>
<div class="section">
<h3><a name="Activity"></a>Activity</h3>
<p>Modularising the configuration is undertaken with the <a href="/apidocs/net/officefloor/activity/ActivitySectionSource.html">ActivitySectionSource</a>. The name <tt>Activity</tt> comes from business. An <tt>Activity</tt> is a composition of many <tt>Procedures</tt>.</p>
<p>The IDE plugins natively support <tt>Activities</tt> so this only becomes a selection when adding a <tt>Section</tt>. However, the application must add support via the following dependency:</p>
<div class="source"><pre class="prettyprint">		&lt;dependency&gt;
			&lt;groupId&gt;net.officefloor.activity&lt;/groupId&gt;
			&lt;artifactId&gt;officeactivity&lt;/artifactId&gt;
		&lt;/dependency&gt;
</pre></div>
<p>To demonstrate using <tt>Activities</tt> to modularise configuraiton, the top level WoOF configuration file is as follows:</p><img src="./images/ActivityHttpServer-configuration.png" alt="ActivityHttpServer screen shot." />
<p>The above configuration has a <tt>Procedure</tt>:</p>
<div class="source"><pre class="prettyprint">	public Depth initiate() {
		return new Depth(0);
	}
</pre></div>
<p>creating and passing on the following parameter:</p>
<div class="source"><pre class="prettyprint">@Data
@AllArgsConstructor
@NoArgsConstructor
public class Depth {

	private Integer level;
}
</pre></div>
<p>to the following modular <tt>Activity</tt>:</p><img src="./images/LevelOne-configuration.png" alt="Level One screen shot." />
<p>Within the above <tt>Activity</tt>, the <tt>Procedure</tt> increments the depth:</p>
<div class="source"><pre class="prettyprint">	public Depth increase(@Parameter Depth depth) {
		return new Depth(depth.getLevel() + 1);
	}
</pre></div>
<p>that is passed onto a further modularised <tt>Activity</tt>:</p><img src="./images/LevelTwo-configuration.png" alt="Level One screen shot." />
<p>that also increases the depth.</p>
<p>The result is then passed out of the modularised <tt>Activity</tt> configurations to the top level <tt>WoOF</tt> configuration to send the result via the following <tt>Procedure</tt>:</p>
<div class="source"><pre class="prettyprint">	public void send(@Parameter Depth depth, ObjectResponse&lt;Depth&gt; response) {
		response.send(depth);
	}
</pre></div></div></div>
<div class="section">
<h2><a name="Complex_Modularising"></a>Complex Modularising</h2>
<p>This is only a simple example of modularising configuration.</p>
<p>More complex <tt>Activity</tt> configurations may have multiple inputs and outputs. Furthermore, they may internally provide exception handling (or let exceptions propagate to a higher <tt>Activity</tt>).</p>
<p>However, only the inputs/outputs are shown to higher level configuration. This encapsulates the modularised <tt>Activity</tt> so developers can change without impacting higher level configurations. This is akin to coding behind interfaces (i.e. configuring behind input/output interfaces).</p>
<p>Furthermore, as the <tt>Activity</tt> is loaded from the class path, <tt>Activities</tt> may be built as libraries. Applications can then import the resulting built jars to re-use the modularised <tt>Activity</tt> functionality.</p></div>
<div class="section">
<h2><a name="Section"></a>Section</h2>
<p>The <tt>Activity</tt> is actually an implementation of a <a href="/apidocs/net/officefloor/compile/spi/section/source/SectionSource.html">SectionSource</a>. The <tt>Section</tt> is the generic modularisation of all configurations. Many of plugins are implemented through <tt>Sections</tt>.</p>
<p>It is beyond this tutorial to give a full explanation of the <a href="/apidocs/net/officefloor/compile/spi/section/source/SectionSource.html">SectionSource</a>. See existing plugins for examples of implementations.</p>
<div class="section">
<h3><a name="Testing"></a>Testing</h3>
<p>The following tests the increased depth of configuration modularisation:</p>
<div class="source"><pre class="prettyprint">	@RegisterExtension
	public MockWoofServerExtension server = new MockWoofServerExtension();

	@Test
	public void correctDepth() throws Exception {
		MockWoofResponse response = this.server.send(MockWoofServer.mockRequest());
		response.assertJson(200, new Depth(2));
	}
</pre></div></div></div>
<div class="section">
<h2><a name="Next"></a>Next</h2>
<p>The <a href="../TransactionHttpServer/index.html">next tutorial</a> covers transaction (<a href="/apidocs/net/officefloor/compile/spi/governance/source/GovernanceSource.html">GovernanceSource</a>) within a WoOF web application.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                <p class="pull-right">Copyright &copy;                    2005&#x2013;2020
                        <a href="http://officefloor.net">OfficeFloor</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
